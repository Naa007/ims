<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<!-- Head -->
<head th:replace="fragments/head :: head"><title>Review Inspection</title></head>
<body>
<!-- Header -->
<header th:replace="fragments/header :: header"></header>
<!-- Main Content -->
<main>
    <div class="page-container">
        <div class="form-card">
            <div class="form-header">
                <h1 class="form-title">Review Inspection</h1>
                <p class="form-subtitle">Please review the Inspector/Reference Documents/Inspection Reports and acknowledge.</p>
            </div>
            <form th:action="@{technical-coordinator/inspection/save}" th:object="${inspection}" method="post" class="needs-validation" novalidate>
                <input type="hidden" th:field="*{id}" id="id" />

                <h5 class="card-title"><i class="fas fa-envelope"></i> <span
                        th:text="'IISPL #' + ${inspection.inspectionNo}"></span></h5>
                
                <!-- notification details -->
                <h4 class="section-header">
                    <i class="fas fa-bell me-2"></i> Notification Details
                </h4>

                <div class="info-section">

                    <!-- Notification No -->
                    <div class="info-item">
                        <i class="fas fa-envelope"></i>
                        <div class="info-content">
                            <div class="info-label">Notification No</div>
                            <div class="info-value" th:text="${inspection.notificationNo}"></div>
                        </div>
                    </div>


                    <!-- Notification Received Date and Time -->
                    <div class="info-item">
                        <i class="fas fa-clock"></i>
                        <div class="info-content">
                            <div class="info-label">Notification Received Date & Time</div>
                            <div class="info-value" th:text="${inspection.notificationReceivedDateTime}"></div>
                        </div>
                    </div>

                    <!-- Client Name -->
                    <div class="info-item">
                        <i class="fas fa-user"></i>
                        <div class="info-content">
                            <div class="info-label">Client Name</div>
                            <div class="info-value" th:text="${inspection.client.clientName+ ' - ' + inspection.client.country}"></div>
                        </div>
                    </div>

                </div>

                <!-- inspection details -->
                <h4 class="section-header">
                    <i class="fas fa-address-card"></i> Inspection Details
                </h4>

                <div class="info-section">
                    <!-- Inspection Country -->
                    <div class="info-item">
                        <i class="fas fa-globe"></i>
                        <div class="info-content">
                            <div class="info-label">Inspection Country</div>
                            <div class="info-value" th:text="${inspection.inspectionCountry}"></div>
                        </div>
                    </div>

                    <!-- Inspection Dates -->
                    <div class="info-item">
                        <i class="fas fa-calendar-alt"></i>
                        <div class="info-content">
                            <div class="info-label">Inspection Dates</div>
                            <ul class="list-unstyled">
                                <li th:each="date : ${inspection.inspectionDateAsPerNotification}" th:text="${date}"
                                    class="info-value"></li>
                            </ul>
                        </div>
                    </div>

                    <!-- Inspection Item -->
                    <div class="info-item">
                        <i class="fas fa-box"></i>
                        <div class="info-content">
                            <div class="info-label">Inspection Item</div>
                            <div class="info-value" th:text="${inspection.inspectionItem}"></div>
                        </div>
                    </div>

                    <!-- Inspection Type -->
                    <div class="info-item">
                        <i class="fas fa-list-alt"></i>
                        <div class="info-content">
                            <div class="info-label">Inspection Type</div>
                            <ul class="list-unstyled">
                                <li th:each="type : ${inspection.inspectionType}" th:text="${type}" class="info-value"></li>
                            </ul>
                        </div>
                    </div>

                    <!-- Inspection Stages -->
                    <div class="info-item">
                        <i class="fas fa-tasks"></i>
                        <div class="info-content">
                            <div class="info-label">Inspection Stages</div>
                            <p id="inspectionActivityWithStages" th:text="${inspection.inspectionActivityWithStages}"
                               class="info-value"></p>
                        </div>
                    </div>

                    <!-- Inspection Location Details -->
                    <div class="info-item">
                        <i class="fas fa-map-marker"></i>
                        <div class="info-content">
                            <div class="info-label">Inspection Location Details</div>
                            <p id="inspectionLocationDetails" th:text="${inspection.inspectionLocationDetails}"
                               class="info-value"></p>
                        </div>
                    </div>

                </div>

                <!-- inspector details -->
                <h4 class="section-header">
                    <i class="fas fa-users"></i> Inspector Details
                </h4>

                <div class="row g-3 mb-4">

                    <!-- Proposed CVs Iteration -->
                    <div class="col-md-12 mt-4">
                        <label class="form-label mb-2">Proposed Inspectors</label>
                        <div class="table-responsive">

                            <table class="table table-bordered table-striped" id="proposedCVsTable">
                                <thead>
                                <tr class="text-center">
                                    <th>Inspector Name</th>
                                    <th>CV Available</th>
                                    <th>Technical Coordinator</th>
                                    <th>PQR Available</th>
                                    <th>ADD or Review PQR</th>
                                </tr>
                                </thead>
                                <tbody>

                                <!-- Existing CVs -->
                                <tr th:each="cv, iterStat : ${inspection.proposedCVs}">
                                    <input type="hidden" th:field="*{proposedCVs[__${iterStat.index}__].id}" th:value="${cv.id}"/>
                                    <td>
                                        <select class="form-select form-select-sm"
                                                th:field="*{proposedCVs[__${iterStat.index}__].inspector.inspectorId}" disabled>
                                            <option th:value="${cv.inspector.inspectorId}"
                                                    th:text="${cv.inspector.inspectorName}">
                                            </option>
                                        </select>
                                    </td>
                                    <td class="text-center">
                                        <div class="d-flex justify-content-center align-items-center">
                                            <select class="form-select form-select-sm"
                                                    th:name="proposedCVs[__${iterStat.index}__].cvCertificatesAvailable" disabled>
                                                <option value="true" th:selected="${cv.cvCertificatesAvailable == true}">Yes</option>
                                                <option value="false" th:selected="${cv.cvCertificatesAvailable == false}">No</option>
                                            </select>
                                        </div>

                                    </td>
                                    <td>
                                        <select class="form-select form-select-sm"
                                                th:field="*{proposedCVs[__${iterStat.index}__].cvReviewByTechnicalCoordinator.empId}"
                                                disabled>
                                            <option th:value="${cv.cvReviewByTechnicalCoordinator.empId}"
                                                    th:text="${cv.cvReviewByTechnicalCoordinator.empName}">
                                            </option>
                                        </select>
                                    </td>
                                    <td class="text-center">
                                        <div class="d-flex justify-content-center align-items-center">
                                            <select class="form-select form-select-sm" th:name="proposedCVs[__${iterStat.index}__].pqrAvailable">
                                                <option value="" disabled selected>Select</option> <!-- Placeholder -->
                                                <option value="true" th:selected="${cv.pqrAvailable == true}">Yes</option>
                                                <option value="false" th:selected="${cv.pqrAvailable == false}">No</option>
                                            </select>
                                        </div>
                                    </td>
                                    <td>
                                        <button
                                                type="button"
                                                onclick="editPQRForm('1')">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button
                                                type="button"
                                                onclick="viewPQRForm('1'')">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </td>>
                                </tr>
                                </tbody>
                            </table>

                        </div>

                    </div>
                </div>

                <!-- inspection progress -->
                <h4 class="section-header">
                    <i class="fas fa-cogs process-icon"></i> Inspection Progress
                </h4>

                <div class="row g-3 mb-4">

                    <!-- Approved Inspector Name -->
                    <div class="col-md-6">
                        <label for="approvedInspectorName" class="form-label">Approved Inspector Name</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-user"></i></span>
                            <input type="text" id="approvedInspectorName" th:field="*{approvedInspectorName}"
                                   class="form-control" readonly/>
                        </div>
                    </div>

                    <!-- Order Confirmation Date -->
                    <div class="col-md-6">
                        <label for="orderConfirmationDate" class="form-label">Date of Order Confirmation</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-calendar-check"></i></span>
                            <input type="date" id="orderConfirmationDate" th:field="*{orderConfirmationDate}"
                                   th:value="*{orderConfirmationDate != null ? orderConfirmationDate : ''}"
                                   class="form-control" />
                        </div>
                    </div>

                    <!--- Sector Scope -->
                    <div class="col-md-6">
                        <label for="sectorScope" class="form-label">Sector Scope</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-industry"></i></span>
                            <input type="text" id="sectorScope" th:field="*{sectorScope}" class="form-control" />
                        </div>
                    </div>

                    <!--- End Client Name -->
                    <div class="col-md-6">
                        <label for="endClientName" class="form-label">End Client Name</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-user-tie"></i></span>
                            <input type="text" id="endClientName" th:field="*{endClientName}" class="form-control" />
                        </div>
                    </div>

                    <!-- Project Name -->
                    <div class="col-md-6">
                        <label for="projectName" class="form-label">Project Name</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-project-diagram"></i></span>
                            <input type="text" id="projectName" th:field="*{projectName}" class="form-control" />
                        </div>
                    </div>
                </div>

                <h4 class="section-header">
                    <i class="fas fa-file-alt"></i> Documentation Process
                </h4>

                <div class="row g-3 mb-4">

                    <!-- Reference Documents -->
                    <div class="col-md-6">
                        <label class="form-label">Reference Documents</label>
                        <div class="input-group">
                            <span class="input-group-text me-3"><i class="fas fa-file"></i></span>
                            <div class="d-flex align-items-center">
                                <div class="form-check me-3">
                                    <input type="radio" id="referenceDocumentsYes" name="referenceDocumentsForInspectionStatus" value="true" th:checked="${inspection.referenceDocumentsForInspectionStatus == true}" class="form-check-input" />
                                    Available
                                </div>
                                <div class="form-check">
                                    <input type="radio" id="referenceDocumentsNo" name="referenceDocumentsForInspectionStatus" value="false" th:checked="${inspection.referenceDocumentsForInspectionStatus == false}" class="form-check-input" />
                                    Not Available
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Documents Reviewed By Technical Coordinator -->
                    <div class="col-md-6">
                        <label class="form-label">Documents Reviewed By Technical Coordinator</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-user-check"></i></span>
                            <select id="documentsReviewedByTechnicalCoordinator" class="form-select"
                                    th:field="*{documentsReviewedByTechnicalCoordinator}" style="min-width: 200px;" >
                                <option value="">Select Technical Coordinator</option>
                                <option th:each="coordinator : ${inspection.technicalCoordinatorsList}"
                                        th:value="${coordinator.empName}"
                                        th:text="${coordinator.empName}"></option>
                            </select>
                        </div>
                    </div>

                    <!-- Contract Review Prepared -->
                    <div class="col-md-6">
                        <label class="form-label">Contract Review Prepared</label>
                        <div class="input-group">
                            <span class="input-group-text me-3"><i class="fas fa-file-alt"></i></span>
                            <div class="d-flex align-items-center">
                                <div class="form-check me-3">
                                    <input type="radio" id="contractReviewYes" name="contractReviewPrepared" value="true" th:checked="${inspection.contractReviewPrepared == true}" class="form-check-input" />
                                    Yes
                                </div>
                                <div class="form-check">
                                    <input type="radio" id="contractReviewNo" name="contractReviewPrepared" value="false" th:checked="${inspection.contractReviewPrepared == false}" class="form-check-input" />
                                    No
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Inspection Advise Note -->
                    <div class="col-md-6">
                        <label class="form-label me-3">Inspection Advise Note</label>
                        <div class="input-group">
                            <span class="input-group-text me-3"><i class="fas fa-sticky-note"></i></span>
                            <div class="d-flex align-items-center">
                                <div class="form-check me-3">
                                    <input type="radio" id="adviseNoteYes" name="inspectionAdviseNote" value="true" th:checked="${inspection.inspectionAdviseNote == true}" class="form-check-input" />
                                    Yes
                                </div>
                                <div class="form-check">
                                    <input type="radio" id="adviseNoteNo" name="inspectionAdviseNote" value="false" th:checked="${inspection.inspectionAdviseNote == false}" class="form-check-input" />
                                    No
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Inspection Process -->
                <h4 class="section-header">
                    <i class="fas fa-cogs"></i> Inspection Process
                </h4>

                <div class="row g-3 mb-4">

                    <!-- Instructions to Inspector Date -->
                    <div class="col-md-6">
                        <label for="instructionsToInspectorDate" class="form-label">Instructions to Inspector Date</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-clipboard-list"></i></span>
                            <input type="date" id="instructionsToInspectorDate" th:field="*{instructionsToInspectorDate}" class="form-control"/>
                        </div>
                    </div>

                    <!-- Any Inspection Issues -->
                    <div class="col-md-6">
                        <label class="form-label">Any Inspection Issues</label>
                        <div class="input-group">
                            <span class="input-group-text me-3"><i class="fas fa-exclamation-triangle"></i></span>
                            <div class="d-flex align-items-center">
                                <div class="form-check me-3">
                                    <input type="radio" id="inspectionIssuesYes" name="anyInspectionIssues" value="true" th:checked="${inspection.anyInspectionIssues == true}" class="form-check-input" />
                                    Yes
                                </div>
                                <div class="form-check">
                                    <input type="radio" id="inspectionIssuesNo" name="anyInspectionIssues" value="false" th:checked="${inspection.anyInspectionIssues == false}" class="form-check-input" />
                                    No
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- FR Sent To Client Date -->
                    <div class="col-md-6">
                        <label for="frSentToClientDate" class="form-label">FR Sent To Client Date</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-share-square"></i></span>
                            <input type="date" id="frSentToClientDate" th:field="*{frSentToClientDate}" class="form-control"/>
                        </div>
                    </div>

                    <!-- Inspection Reports Received Date -->
                    <div class="col-md-6">
                        <label for="inspectionReportsReceivedDate" class="form-label">Inspection Reports Received
                            Date</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-file-download"></i></span>
                            <input type="date" id="inspectionReportsReceivedDate" th:field="*{inspectionReportsReceivedDate}"
                                   class="form-control" />
                        </div>
                    </div>

                    <!-- Inspection Reviewed By -->
                    <div class="col-md-6">
                        <label for="inspectionReviewedBy" class="form-label">Inspection Reviewed By</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-user-edit"></i></span>
                            <select id="inspectionReviewedBy" class="form-select" th:field="*{inspectionReviewedBy}" >
                                <option value="">Select Reviewer</option>
                                <option th:each="coordinator : ${inspection.technicalCoordinatorsList}"
                                        th:value="${coordinator.empName}"
                                        th:text="${coordinator.empName}"></option>
                            </select>
                        </div>
                    </div>

                    <!-- Inspection Support Documents Sent Date -->
                    <div class="col-md-6">
                        <label for="inspectionSupportDocumentsSentDate" class="form-label">Inspection Support Documents
                            Sent Date</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-paper-plane"></i></span>
                            <input type="date" id="inspectionSupportDocumentsSentDate"
                                   th:field="*{inspectionSupportDocumentsSentDate}" class="form-control" />
                        </div>
                    </div>

                    <!-- Inspection Report Number -->
                    <div class="col-md-6">
                        <label for="inspectionReportNumber" class="form-label">
                            Inspection Report Number</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-hashtag"></i></span>
                            <input type="text" id="inspectionReportNumber"
                                   th:field="*{inspectionReportNumber}" class="form-control" />
                        </div>
                    </div>

                    <!-- NCR Raised -->
                    <div class="col-md-6">
                        <label class="form-label">NCR Raised</label>
                        <div class="input-group">
                            <span class="input-group-text me-3"><i class="fas fa-exclamation-circle"></i></span>
                            <div class="d-flex align-items-center">
                                <div class="form-check me-3">
                                    <input type="radio" id="ncrRaisedYes" name="ncrRaised" value="true" th:checked="${inspection.ncrRaised == true}" class="form-check-input" />
                                    Yes
                                </div>
                                <div class="form-check">
                                    <input type="radio" id="ncrRaisedNo" name="ncrRaised" value="false" th:checked="${inspection.ncrRaised == false}" class="form-check-input" />
                                    No
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- IRN Sent Date -->
                    <div class="col-md-6">
                        <label for="irnSentDate" class="form-label">IRN Sent Date</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-paperclip"></i></span>
                            <input type="date" id="irnSentDate" th:field="*{irnSentDate}" class="form-control" />
                        </div>
                    </div>

                    <!-- Impartiality and Confidentiality -->
                    <div class="col-md-6">
                        <label class="form-label">Impartiality and Confidentiality</label>
                        <div class="input-group">
                            <span class="input-group-text me-3"><i class="fas fa-balance-scale"></i></span>
                            <div class="d-flex align-items-center">
                                <div class="form-check me-3">
                                    <input type="radio" id="impartialityYes" name="impartialityAndConfidentiality" value="true" th:checked="${inspection.impartialityAndConfidentiality == true}" class="form-check-input" />
                                    Yes
                                </div>
                                <div class="form-check">
                                    <input type="radio" id="impartialityNo" name="impartialityAndConfidentiality" value="false" th:checked="${inspection.impartialityAndConfidentiality == false}" class="form-check-input" />
                                    No
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Job Folder Link -->
                    <div class="col-md-6">
                        <label for="jobFolderLink" class="form-label">Job Folder Link</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-link"></i></span>
                            <input type="url" id="jobFolderLink" th:field="*{jobFolderLink}" class="form-control"
                                   placeholder="Enter the URL" />
                        </div>
                    </div>


                    <!-- Inspection Status -->
                    <div class="col-md-6">
                        <label for="inspectionStatus" class="form-label required-field">Inspection Status</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-info-circle"></i></span>
                            <select id="inspectionStatus" class="form-select" th:field="*{inspectionStatus}" required>
                                <option value="">Select Status</option>
                                <option th:each="inspectionStatusType : ${T(com.stepup.ims.model.Inspection.InspectionStatusType).values()}"
                                        th:value="${inspectionStatusType}"
                                        th:text="${inspectionStatusType.description}"></option>
                            </select>
                        </div>
                    </div>


                </div>

                <!-- Submit Button -->
                <div class="col-12 d-flex justify-content-center">
                    <button type="submit" class="btn btn-primary">
                        Edit Inspection
                    </button>
                </div>

            </form>
        </div>
    </div>
</main>
<!-- Footer -->
<footer th:replace="fragments/footer :: footer"></footer>
</body>
</html>